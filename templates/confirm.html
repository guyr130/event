<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <title>אישור הגעה</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="margin:0;padding:0;font-family:Arial;direction:rtl;text-align:center;">

<div style="max-width:420px;margin:0 auto;padding:20px;">

    <h2>אישור הגעה</h2>

    <p>
        אושרו לכם <strong>{{ tickets }}</strong> כרטיסים
    </p>

    <select id="qty">
        <option value="">בחרו כמות</option>
        {% for i in range(1, tickets + 1) %}
        <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
    </select>

    <br><br>

    <button onclick="send('yes')">מגיעים</button>
    <button onclick="send('no')">לא מגיעים</button>

</div>

<script>
function send(status) {
    let qty = document.getElementById("qty").value;
    if (status === "yes" && !qty) {
        alert("בחרו כמות");
        return;
    }
    if (status === "no") qty = 0;

    fetch("/submit", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            event_id: "{{ event_id }}",
            family_id: "{{ family_id }}",
            tickets: qty,
            status: status
        })
    }).then(() => {
        window.location.href = "/thanks";
    });
}
</script>

</body>
</html>
